---
title: "h2"
author: "natashasanthanam"
date: "2020-10-28"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

Histogram and Summary Statistics for both Pvalues and H2 values generated by GCTA

Using this for loop, I generated the gcta output for all 256 phenotypes. I also ran the for loop again with the permuted phenotype file
```{sh eval=FALSE}
for i in {1..256}
do 
gcta --grm-bin /gpfs/data/im-lab/nas40t2/Data/GTEx/V8/genotype/plink_files/GTEX_grm_output --pheno /gpfs/data/im-lab/nas40t2/natasha/GTEX_Analysis/pheno_gtex_perm.txt --reml-no-constrain --out /gpfs/data/im-lab/nas40t2/natasha/GTEX_Analysis/perm_loop/gtex_output_perm_$i --thread-num 4 --mpheno $i
done
```


```{sh eval=FALSE}
library(workflowr)
library(tidyverse)
library(dplyr)
DATA="/Users/natashasanthanam/Github/GTEX-Analysis"
```


Pvalues and H2 values for GCTA output
```{sh eval=FALSE}
pval = read_tsv(glue::glue("{DATA}/pval.txt" ), col_names = FALSE)
hist(pval$X2)
summary(pval$X2)

h2 = read_tsv(glue::glue("{DATA}/vgvp.txt"),col_names=FALSE)
summary(h2$X2)
t.test(h2$X2)
```

Pvalues and H2 values for GCTA output generated using permuted phenotype file
```{sh eval=FALSE}
pval_perm = read_tsv(glue::glue("{DATA}/pval_perm.txt" ), col_names = FALSE)
h2_perm = read_tsv(glue::glue("{DATA}/vgvp_perm.txt" ), col_names = FALSE)

hist(pval_perm$X2)
summary(pval_perm$X2)

summary(h2_perm$X2)
t.test(h2_perm$X2)


```





